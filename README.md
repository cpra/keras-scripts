
# Keras Scripts #

A collection of scripts based on [Keras](https://github.com/fchollet/keras) that I use for training, testing, and applying CNNs.

Supports Python 3.5 and Keras 0.3 (other versions might work too).

## Scripts ##

The repository currently contains the following scripts. More to follow.

### `train.py` ###

`train.py` is used for training (or fine-tuning) Keras CNNs. The script works in conjunction with a JSON file that encodes general properties that usually do not change often, such as the net and data to use. See `train.example.json` for an example. The network structure itself is expected to be returned by a Python function, see `train.example.json` and `kutils/netdefs.py` for examples.

The script saves model weights in the form `MODEL_ep3.h5`, where `ep3` means "after third training epoch". For each weights file there is a corresponding info file, e.g. `MODEL_ep3.h5.info` that stores everything needed to use the trained model, including network structure and preprocessing information. Furthermore, the script will create a log file (by default `MODEL.log`) that contains information on the training progress.

`train.py` expects the training data to be stored in one or several HDF5 files, and these files must have two datasets, `X` (a samples * channels * rows * columns numpy array of feature vectors) and `y` (a samples, numpy array of class labels). See `train.example.json`.

### `visualize_log.py` ###

`visualize_log.py` can be used to visualize logs generated by `train.py` in order to get a better idea of how training progressed (or progresses, the script supports logs that are being written).

### `test.py` ###

`test.py` is used for testing a model trained using `train.py` on test data in the form of a single HDF5 file (see notes on `train.py` for details). The scripts uses a `.info` file to figure out which model, weights, and preprocessing to use.

## Author ###

Christopher Pramerdorfer
CVL, TU Wien, Vienna, Austria

## License ##

[zlib](https://en.wikipedia.org/wiki/Zlib_License)
